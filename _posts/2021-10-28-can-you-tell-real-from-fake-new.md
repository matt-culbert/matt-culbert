---
layout: post
title: 'Can You Tell Real From Fake: Lightshot Malware Campaign'
date: '2021-10-28T13:34:00.016-07:00'
author: Matt C
tags: 
modified_time: '2021-11-01T09:03:41.983-07:00'
thumbnail: https://blogger.googleusercontent.com/img/a/AVvXsEhpF01WOcT83kd0gH0eWDAmR7s0is92pI1dbfOPgRy9xXr9kLKxdJAbZvk_wMh3IfB1mZWFoxdk6DT9xGH0DlbQocQuot6rmzzI2fu1GT0AvTKvXkz_y1nxaiemqwNJgZzcdrZe-HQfz2LX-gwESLzK0qqhBx-XNvyUfxsHBfO2lK6EG7mmRHKeB4FMYg=s72-c
blogger_id: tag:blogger.com,1999:blog-8951407132095927802.post-551116578719601098
blogger_orig_url: https://cr.culbertreport.com/2021/10/can-you-tell-real-from-fake-new.html
---

<h2 style="text-align: left;">Background:</h2><p style="text-align: left;">Lightshot is a utility for Windows and Macs that allows you to take screenshots of select portions of your screen. It's handy if you don't want to use the built in Windows function which is honestly lacking. Personally I recommend Greenshot. <br /></p><h2 style="text-align: left;">How the campaign works:</h2><p style="text-align: left;">Honestly, this is well put together. The attackers paid money to get this to be the first result on Google through advertisements. See below:</p><p style="text-align: left;"></p><div class="separator" style="clear: both; text-align: center;"></div><div class="separator" style="clear: both; text-align: center;"><a href="https://blogger.googleusercontent.com/img/a/AVvXsEhpF01WOcT83kd0gH0eWDAmR7s0is92pI1dbfOPgRy9xXr9kLKxdJAbZvk_wMh3IfB1mZWFoxdk6DT9xGH0DlbQocQuot6rmzzI2fu1GT0AvTKvXkz_y1nxaiemqwNJgZzcdrZe-HQfz2LX-gwESLzK0qqhBx-XNvyUfxsHBfO2lK6EG7mmRHKeB4FMYg=s818" style="margin-left: 1em; margin-right: 1em;"><img border="0" data-original-height="717" data-original-width="818" height="280" src="https://blogger.googleusercontent.com/img/a/AVvXsEhpF01WOcT83kd0gH0eWDAmR7s0is92pI1dbfOPgRy9xXr9kLKxdJAbZvk_wMh3IfB1mZWFoxdk6DT9xGH0DlbQocQuot6rmzzI2fu1GT0AvTKvXkz_y1nxaiemqwNJgZzcdrZe-HQfz2LX-gwESLzK0qqhBx-XNvyUfxsHBfO2lK6EG7mmRHKeB4FMYg=s320" width="320" /></a></div>And if you go to the website, I can't blame people for not being able to tell the difference:<br /><p></p><div class="separator" style="clear: both; text-align: center;"><a href="https://blogger.googleusercontent.com/img/a/AVvXsEi_6qWXQH4XaAcSHK992pboHXIBOyZH2Z3RXc-cYBGOvBiltMQuoYxXSKWrYxUMOdfKEAmJzZS4eTRaTXjuWt4F7NipGQnR6U-r1Db2V15oFpGprB21bc4FhOBJKo8I9v0fFMx1fQZhHNgOskhchSx2Q0HecMdJ4ChemzfJwvg-vWR_8eK1b5876B1nYQ=s1920" style="margin-left: 1em; margin-right: 1em;"><img border="0" data-original-height="1160" data-original-width="1920" height="290" src="https://blogger.googleusercontent.com/img/a/AVvXsEi_6qWXQH4XaAcSHK992pboHXIBOyZH2Z3RXc-cYBGOvBiltMQuoYxXSKWrYxUMOdfKEAmJzZS4eTRaTXjuWt4F7NipGQnR6U-r1Db2V15oFpGprB21bc4FhOBJKo8I9v0fFMx1fQZhHNgOskhchSx2Q0HecMdJ4ChemzfJwvg-vWR_8eK1b5876B1nYQ=w481-h290" width="481" /></a></div><p>The image on the right is the fake site, well built to mimic the real one on the left. And if you download the fake version, you actually do get Lightshot installed, but also an old NetSupport client compiled in 2009:</p><div class="separator" style="clear: both; text-align: center;"><a href="https://blogger.googleusercontent.com/img/a/AVvXsEh6Qgwtud9g0wLwGsF80_jz0Kl08U3M778JtCDaIC-J-oj5Qtt3OdbR-7Qf2MXvofB5n2-X81gN7BenRt6RHrT0jlCmX42P3sBYL5CJWGt9zaQaAihJpR8rGJtEMzVcjjrYPjIucVBkpEL2culvCTar3aqdeyK3dc2Ydj0O6hVuI2eKpCzVKPHOc0tLgA=s831" style="margin-left: 1em; margin-right: 1em;"><img border="0" data-original-height="159" data-original-width="831" height="72" src="https://blogger.googleusercontent.com/img/a/AVvXsEh6Qgwtud9g0wLwGsF80_jz0Kl08U3M778JtCDaIC-J-oj5Qtt3OdbR-7Qf2MXvofB5n2-X81gN7BenRt6RHrT0jlCmX42P3sBYL5CJWGt9zaQaAihJpR8rGJtEMzVcjjrYPjIucVBkpEL2culvCTar3aqdeyK3dc2Ydj0O6hVuI2eKpCzVKPHOc0tLgA=w378-h72" width="378" /></a></div><br /><p></p><div class="separator" style="clear: both; text-align: center;"><a href="https://blogger.googleusercontent.com/img/a/AVvXsEha23BbbrnMvASkItJle_Uoj0qO_AfgE96u9vgXegKrCckNYoqDrUdQbdU2rlzPyvYOWc2xOoxFS21O73g3F3NpXbjwNzVmcMiUI-IbFU0UShvlu3_6CQGXjdHXWziKb9St36R44vFwZbO0-sjM6thpKx7tB8zVsDPFdnY7JcK94QtjPQkLtOm16MS5nw=s438" style="margin-left: 1em; margin-right: 1em;"><img border="0" data-original-height="15" data-original-width="438" height="20" src="https://blogger.googleusercontent.com/img/a/AVvXsEha23BbbrnMvASkItJle_Uoj0qO_AfgE96u9vgXegKrCckNYoqDrUdQbdU2rlzPyvYOWc2xOoxFS21O73g3F3NpXbjwNzVmcMiUI-IbFU0UShvlu3_6CQGXjdHXWziKb9St36R44vFwZbO0-sjM6thpKx7tB8zVsDPFdnY7JcK94QtjPQkLtOm16MS5nw=w582-h20" width="582" /></a></div><div class="separator" style="clear: both; text-align: center;"><a href="https://blogger.googleusercontent.com/img/a/AVvXsEhpl3qrbT71Cxu2fjuhvcHeUaFghdhDhi4ERITqD_Kytm0AhaL9SGvxpVBoF-EM_XLc-rWJ_PL46P07_JMmv9H23I2Yc5swIPyIfDzSBsQ0ebWUOHEdgq4LHeogEcB5b8fl3KLRrK7J5QcwQAd8_WpR26PHNxKL8uj3pZt5sOUsRSSX8iFrhlEY7o1x8Q=s527" style="margin-left: 1em; margin-right: 1em;"><img border="0" data-original-height="381" data-original-width="527" height="220" src="https://blogger.googleusercontent.com/img/a/AVvXsEhpl3qrbT71Cxu2fjuhvcHeUaFghdhDhi4ERITqD_Kytm0AhaL9SGvxpVBoF-EM_XLc-rWJ_PL46P07_JMmv9H23I2Yc5swIPyIfDzSBsQ0ebWUOHEdgq4LHeogEcB5b8fl3KLRrK7J5QcwQAd8_WpR26PHNxKL8uj3pZt5sOUsRSSX8iFrhlEY7o1x8Q=w305-h220" width="305" /></a></div><h2 style="text-align: left;">Examining the installer:</h2><p style="text-align: left;">If we take a look at the installer in PEStudio, we can see a number of red flags. First, the code was compiled in 2050 - why this is a red flag is self explanatory. Next, it has 0 imports. This suggests that files are imported at run time in order to make static analysis more difficult. Also, the file has a reference to a URL which we'll see utilized below to send some initial information. Finally, the PE has unusually high entropy which indicates that it has packed data.<br /></p><div class="separator" style="clear: both; text-align: center;"><a href="https://blogger.googleusercontent.com/img/a/AVvXsEjq6aYVF26HbYSdMgwUUNJKGWoC26d1UL_i13y8uEmfzcOZTxh3LvqsmA3nggcxQeco6BQhODNUNg_WA804R-z3NcArh_yaRjapSxDSepHoqPTggagAJmRc-1qe0abjiljNzHwOCFa9WQKZA4lYjDnV1RVsFDqNcq5XXS9i9MtL5_hoE12qM6xw8Naj5A=s1191" style="margin-left: 1em; margin-right: 1em;"><img border="0" data-original-height="836" data-original-width="1191" height="261" src="https://blogger.googleusercontent.com/img/a/AVvXsEjq6aYVF26HbYSdMgwUUNJKGWoC26d1UL_i13y8uEmfzcOZTxh3LvqsmA3nggcxQeco6BQhODNUNg_WA804R-z3NcArh_yaRjapSxDSepHoqPTggagAJmRc-1qe0abjiljNzHwOCFa9WQKZA4lYjDnV1RVsFDqNcq5XXS9i9MtL5_hoE12qM6xw8Naj5A=w371-h261" width="371" /></a></div><p></p><p></p><h2 style="text-align: left;">What the malware does:&nbsp;</h2><p style="text-align: left;">When you launch the installer, Lightshot sends out a POST containing your private IP:</p><div class="separator" style="clear: both; text-align: center;"><a href="https://blogger.googleusercontent.com/img/a/AVvXsEjNb6q4PqwjDRhw9lHOoOlob2f8ASBVDxlyc96RB-D8sSqS-skcnHNUDoUwHgi4C-rXCml9z9kW49Bx1MIuHheAz0prPzSqKe-EyVfQZLKSnOlk68kZD7YU6TQd89R_eKmM4aqDSlmvrRQfB_32bCziRN0UFPbN1auBlpKPxnX_6jkIsZbWIZ6q8672Fw=s700" style="margin-left: 1em; margin-right: 1em;"><img border="0" data-original-height="25" data-original-width="700" height="19" src="https://blogger.googleusercontent.com/img/a/AVvXsEjNb6q4PqwjDRhw9lHOoOlob2f8ASBVDxlyc96RB-D8sSqS-skcnHNUDoUwHgi4C-rXCml9z9kW49Bx1MIuHheAz0prPzSqKe-EyVfQZLKSnOlk68kZD7YU6TQd89R_eKmM4aqDSlmvrRQfB_32bCziRN0UFPbN1auBlpKPxnX_6jkIsZbWIZ6q8672Fw=w554-h19" width="554" /></a><div class="separator" style="clear: both; text-align: center;"><a href="https://blogger.googleusercontent.com/img/a/AVvXsEgkXTenFyYcYu9lDpcBY5DcgqOSd1C-tEK3u0Yc3IgzbHQyP6s7aUiZqZvosKnpv2lSvfq3BdDB4W2s-wWCnsKVzaZqHZ0jqDSK6MzF0DiJ1jqsXw7iTZuDqeOy3keq6U3r5M3JFoIYijXeDAVCxapZeflrJef1C_Kk-OhBfTAxVa486418sj24A1kqkQ=s947" style="margin-left: 1em; margin-right: 1em;"><img border="0" data-original-height="710" data-original-width="947" height="321" src="https://blogger.googleusercontent.com/img/a/AVvXsEgkXTenFyYcYu9lDpcBY5DcgqOSd1C-tEK3u0Yc3IgzbHQyP6s7aUiZqZvosKnpv2lSvfq3BdDB4W2s-wWCnsKVzaZqHZ0jqDSK6MzF0DiJ1jqsXw7iTZuDqeOy3keq6U3r5M3JFoIYijXeDAVCxapZeflrJef1C_Kk-OhBfTAxVa486418sj24A1kqkQ=w428-h321" width="428" /></a></div><br /></div>Once you have Lightshot installed on your PC, a number of actions follow. First, you'll notice that Net Support is installed under C:\Users\Public\support, which is a common location for files trying to hide. Then you have a new registry key created for persistence with support.exe:<div class="separator" style="clear: both; text-align: center;"></div><div class="separator" style="clear: both; text-align: center;"></div><div class="separator" style="clear: both; text-align: center;"></div><div class="separator" style="clear: both; text-align: center;"><a href="https://blogger.googleusercontent.com/img/a/AVvXsEhDP8KpAa8XWZu6krppLLPlxFpwZdA6-6mH1veB3amfw4aIIzqfl8Zh5Fhtaee6v5QBgcOtPai0z2hW7BMoAgZxbOYmNqFHsjRXNCu-ghIojdTnDKdIY7Vpp9ULYLbLhT6RHRZ_n5SfVJWukwlc_l-0P3H3mgWLKHmu8S-7UquyXhQoUGqj1yc1-YxQCg=s1052" style="margin-left: 1em; margin-right: 1em;"><img border="0" data-original-height="94" data-original-width="1052" height="48" src="https://blogger.googleusercontent.com/img/a/AVvXsEhDP8KpAa8XWZu6krppLLPlxFpwZdA6-6mH1veB3amfw4aIIzqfl8Zh5Fhtaee6v5QBgcOtPai0z2hW7BMoAgZxbOYmNqFHsjRXNCu-ghIojdTnDKdIY7Vpp9ULYLbLhT6RHRZ_n5SfVJWukwlc_l-0P3H3mgWLKHmu8S-7UquyXhQoUGqj1yc1-YxQCg=w531-h48" width="531" /></a></div><p>Then, Support.exe starts attempting to phone home:</p><div class="separator" style="clear: both; text-align: center;"><a href="https://blogger.googleusercontent.com/img/a/AVvXsEikvWcQqyX8RHqVmKdwjEkmzyOM35krRWoPmiDuJbx_tvrwBNSpR5T_Vf8GBncDGMSBjeGbTkbMIX_9c0Qg9MoHpiWwY3Tu1fg07IQMivMEsiy8pvJubPm5nf0yhEweMhLXLo_-Xn_zEFVErbRjWdnbYWsoD5JeSmVpxtDzBWMbS38QfxwaRtRCqi-CiA=s1176" style="margin-left: 1em; margin-right: 1em;"><img border="0" data-original-height="82" data-original-width="1176" height="40" src="https://blogger.googleusercontent.com/img/a/AVvXsEikvWcQqyX8RHqVmKdwjEkmzyOM35krRWoPmiDuJbx_tvrwBNSpR5T_Vf8GBncDGMSBjeGbTkbMIX_9c0Qg9MoHpiWwY3Tu1fg07IQMivMEsiy8pvJubPm5nf0yhEweMhLXLo_-Xn_zEFVErbRjWdnbYWsoD5JeSmVpxtDzBWMbS38QfxwaRtRCqi-CiA=w587-h40" width="587" /></a></div><p></p><p>After phoning home, the attack becomes hands-on-keyboard. Support.exe receives a remote connection from the attacker and a DLL is copied over. Then through remcmdstub.exe, NetSupports tool for running commands, this is run: <span style="color: red;">remcmdstub.exe 1992 1804 2000 2004 %COMSPEC%</span> &amp; <span style="color: red;">remcmdstub.exe 1992 1804 2000 2004 %COMSPEC%</span><br /></p><p>Which spawns<span style="color: red;">: "C:\Windows\System32\rundll32.exe" "c:\Intel\6789341.dll" <span style="color: black;">&nbsp;</span></span></p><p><span style="color: red;"><span style="color: black;">This DLL that is attempted to run is a Cobaltstrike beacon. Once ran, antivirus flagged it and stopped it from executing further, and the DLL was subsequently deleted.<br /></span></span></p><h2 style="text-align: left;"><span style="color: red;"><span style="color: black;">Wrapping up:</span></span></h2><p style="text-align: left;"><span style="color: red;"><span style="color: black;">It's hard for average users to stay abreast of this type of campaign when the attackers do such a good job mimicking the real site and installer, not to mention the installer is signed and verified so Windows won't throw any errors. This is made even more so when they buy ad space that manages to come before the legitimate site in searches. It's important to remember to check the URL, in this case the giveaway being the extra "n" in the URL, as this the least you can do to keep yourself protected. Up to date antivirus is also evidently important since it will stop beacons from reaching out and further compromising the system. Watching for foreign IP's can only do so much as the ones in this case were a mix of Asian and American systems. This also isn't the first time <a href="https://www.fireeye.com/blog/threat-research/2018/04/fake-software-update-abuses-netsupport-remote-access-tool.html">something like this</a> has happened. </span></span></p><h2 style="text-align: left;"><span style="color: red;"><span style="color: black;">IOC:</span></span></h2><p style="text-align: left;"><span style="color: red;"><span style="color: black;">66.29.138[.]19</span></span></p><p style="text-align: left;"><span style="color: red;"><span style="color: black;">103.159.132[.]236&nbsp;</span></span></p><p style="text-align: left;"><span style="color: red;"><span style="color: black;"><span style="color: red;"><span style="color: black;">http://transferdataflows[.]com/updscrc.php&nbsp; </span></span><br /></span></span></p><p style="text-align: left;"><span style="color: red;"><span style="color: black;">ad49c28159f0d5a6e974e5e55518357196583dac6751cb31f2328739b326a30c - setup-lightshot</span></span></p><p style="text-align: left;"><span style="color: red;"><span style="color: black;">275e5b085534f64313b50cbdcb08ecd59c57d21c96bb937f140ee92a3d27f792 - NetSupport/client32 </span></span></p><div style="box-sizing: border-box; font-family: &quot;Segoe UI&quot;, system-ui, &quot;Apple Color Emoji&quot;, &quot;Segoe UI Emoji&quot;, sans-serif; font-size: 16px; font-style: normal; font-variant-caps: normal; font-variant-ligatures: normal; font-weight: 400; letter-spacing: normal; text-align: start; text-indent: 0px; text-transform: none; white-space: normal; word-spacing: 0px;">41c6ffc32baad42ccc8ffd3c17e74c30fccc401bd0c65f22a63fec1cd5e5a192 - DLL<br /></div><p>&nbsp;</p><p></p><div class="separator" style="clear: both; text-align: center;"></div><div class="separator" style="clear: both; text-align: center;"></div><div class="separator" style="clear: both; text-align: center;"></div><div class="separator" style="clear: both; text-align: center;"></div><div class="separator" style="clear: both; text-align: center;"></div><div class="separator" style="clear: both; text-align: center;"></div><div class="separator" style="clear: both; text-align: center;"></div><div class="separator" style="clear: both; text-align: center;"></div><div class="separator" style="clear: both; text-align: center;"></div><div class="separator" style="clear: both; text-align: center;"></div><div class="separator" style="clear: both; text-align: center;"></div><div class="separator" style="clear: both; text-align: center;"></div><div class="separator" style="clear: both; text-align: center;"></div><div class="separator" style="clear: both; text-align: center;"></div><div class="separator" style="clear: both; text-align: center;"></div><div class="separator" style="clear: both; text-align: center;"></div><div class="separator" style="clear: both; text-align: center;"></div><div class="separator" style="clear: both; text-align: center;"></div><div class="separator" style="clear: both; text-align: center;"></div><div class="separator" style="clear: both; text-align: center;"></div>