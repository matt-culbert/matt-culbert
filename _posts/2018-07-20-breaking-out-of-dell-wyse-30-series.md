---
layout: post
title: Breaking Out Of Dell Wyse 30 Series ThinClients & How To Stop This
date: '2018-07-20T18:55:00.006-07:00'
author: Matt C
tags: 
modified_time: '2021-07-26T19:50:29.135-07:00'
thumbnail: https://2.bp.blogspot.com/-LLgsrVuPoeg/W1I__u7a-0I/AAAAAAAAAHo/T4ZHQAlYk2YcKox5ll340y9CMDp47ROAgCLcBGAs/s72-c/wyse.jpg
blogger_id: tag:blogger.com,1999:blog-8951407132095927802.post-2447386615910669926
blogger_orig_url: https://cr.culbertreport.com/2018/07/breaking-out-of-dell-wyse-30-series.html
---

<br /><div class="separator" style="clear: both; text-align: center;"><a href="https://2.bp.blogspot.com/-LLgsrVuPoeg/W1I__u7a-0I/AAAAAAAAAHo/T4ZHQAlYk2YcKox5ll340y9CMDp47ROAgCLcBGAs/s1600/wyse.jpg" style="margin-left: 1em; margin-right: 1em;"><img border="0" data-original-height="1600" data-original-width="1200" height="320" src="https://2.bp.blogspot.com/-LLgsrVuPoeg/W1I__u7a-0I/AAAAAAAAAHo/T4ZHQAlYk2YcKox5ll340y9CMDp47ROAgCLcBGAs/s320/wyse.jpg" width="240" /></a></div><div class="separator" style="clear: both; text-align: center;"><br /></div><div class="separator" style="clear: both; text-align: left;">This was post was updated 9/21/2018</div><br /><br />ThinClients are somewhat ubiquitous&nbsp;in businesses. They reduce the overhead for onboarding new employees, are easy to manage, reduce the maintenance costs of desktops, and are all around good alternatives for companies who can spend money better elsewhere.<br /><br />The 3040 comes locked down with no right-click functionality, you can't access&nbsp;windows explorer, and you can't open command prompt or the run dialogue/taskmanager.<br /><br />There are very few default apps available.<br /><br /><div class="separator" style="clear: both; text-align: left;"></div>However, ThinClients also have inherent&nbsp;flaws in them.<br /><br />The one I am looking at today is the Wyse 3030. This is a full ThinClient with Windows 7 embedded into it with a RAM disk. Out of the box, it is pretty easy to set up and start working and connects easily to virtual hosts. Which is where the trouble begins.<br /><br />This attack hinges on a few options in the VMWare Horizon Client being enabled, pictured below.<br /><div class="separator" style="clear: both; text-align: left;"><a href="https://2.bp.blogspot.com/-DZHIdxeJRbU/W6P0mH6fTCI/AAAAAAAAAKw/GvQYPTgC_m0k295_Hs1WRykLhtrbuwzQQCLcBGAs/s1600/2018-09-20%2B15_24_33-VMware%2BHorizon%2BClient.png" style="margin-left: 1em; margin-right: 1em;"><img border="0" data-original-height="488" data-original-width="534" height="291" src="https://2.bp.blogspot.com/-DZHIdxeJRbU/W6P0mH6fTCI/AAAAAAAAAKw/GvQYPTgC_m0k295_Hs1WRykLhtrbuwzQQCLcBGAs/s320/2018-09-20%2B15_24_33-VMware%2BHorizon%2BClient.png" width="320" /></a></div><br />Once connected to a VM, you will be prompted whether or not you want to mount the local machine and its file system. And you are prompted for this after every time you restart the Wyse machine and connect to a host.<br /><br /><div class="separator" style="clear: both; text-align: left;"></div><div class="separator" style="clear: both; text-align: left;"></div>If you do mount the Wyse machines file system, you've pretty much gained root access. <br /><br />Once your VDI machine is mounted, open the file path and locate the shortcut for command prompt we made and copy it to your Wyse machines desktop folder.<br /><div class="separator" style="clear: both; text-align: left;"><br /></div>Back on the Wyse, you should now have a cmd icon.<br /><br /><div class="separator" style="clear: both; text-align: left;"></div>Opening this will now open a command prompt window that was previously inaccessible for you.<br /><br />Since the default admin password resets on reboot, this should be easy to locate on Google - provided it wasn't set up through Wyse management.<br /><br />Once found, you can use runas&nbsp;to open an administrator powershell prompt within command prompt.<br /><br />To stop this attack, you need to make a registry key on the ThinClient. This, unfortunately, can not be done from the Wyse management studio and has to be done from the local machine itself. Adding this key will stop file sharing on the machine [HKEY_LOCAL_MACHINE\Software\Policies\VMware, Inc.\VMware VDM\Client] “DisableSharing”=”true” (This remediation was taken from&nbsp;https://www.yannickvr.nl/vmware-horizon-view-client-disable-client-drive-redirection/)<br /><br />This issue may seem small but many organizations have a need for securing sensitive data, and the fact that data can be copied down to a machine with no lockdown, and that this machine can be elevated to root easily, means there's an inherent security flaw in this design and ability to secure data.<br /><br />Most companies lock down USB access on VM's but not the thin clients since they are just used as access machines. Even if you are able to lock down the USB level access on the ThinClient, it gets reset on every reboot. If you are able to configure that to be persistent, it still doesn't matter since the user is able to get a command prompt.